function Ws(n,e){return function(){return n.apply(e,arguments)}}const{toString:zn}=Object.prototype,{getPrototypeOf:Kt}=Object,{iterator:tt,toStringTag:Gs}=Symbol,st=(n=>e=>{const t=zn.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),J=n=>(n=n.toLowerCase(),e=>st(e)===n),nt=n=>e=>typeof e===n,{isArray:ge}=Array,Re=nt("undefined");function Me(n){return n!==null&&!Re(n)&&n.constructor!==null&&!Re(n.constructor)&&H(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Js=J("ArrayBuffer");function qn(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Js(n.buffer),e}const Wn=nt("string"),H=nt("function"),Xs=nt("number"),Ne=n=>n!==null&&typeof n=="object",Gn=n=>n===!0||n===!1,Ge=n=>{if(st(n)!=="object")return!1;const e=Kt(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Gs in n)&&!(tt in n)},Jn=n=>{if(!Ne(n)||Me(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},Xn=J("Date"),Yn=J("File"),Zn=J("Blob"),Qn=J("FileList"),er=n=>Ne(n)&&H(n.pipe),tr=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||H(n.append)&&((e=st(n))==="formdata"||e==="object"&&H(n.toString)&&n.toString()==="[object FormData]"))},sr=J("URLSearchParams"),[nr,rr,ir,or]=["ReadableStream","Request","Response","Headers"].map(J),ar=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ke(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let s,r;if(typeof n!="object"&&(n=[n]),ge(n))for(s=0,r=n.length;s<r;s++)e.call(null,n[s],s,n);else{if(Me(n))return;const i=t?Object.getOwnPropertyNames(n):Object.keys(n),o=i.length;let l;for(s=0;s<o;s++)l=i[s],e.call(null,n[l],l,n)}}function Ys(n,e){if(Me(n))return null;e=e.toLowerCase();const t=Object.keys(n);let s=t.length,r;for(;s-- >0;)if(r=t[s],e===r.toLowerCase())return r;return null}const re=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Zs=n=>!Re(n)&&n!==re;function xt(){const{caseless:n}=Zs(this)&&this||{},e={},t=(s,r)=>{const i=n&&Ys(e,r)||r;Ge(e[i])&&Ge(s)?e[i]=xt(e[i],s):Ge(s)?e[i]=xt({},s):ge(s)?e[i]=s.slice():e[i]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&ke(arguments[s],t);return e}const lr=(n,e,t,{allOwnKeys:s}={})=>(ke(e,(r,i)=>{t&&H(r)?n[i]=Ws(r,t):n[i]=r},{allOwnKeys:s}),n),cr=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),ur=(n,e,t,s)=>{n.prototype=Object.create(e.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},hr=(n,e,t,s)=>{let r,i,o;const l={};if(e=e||{},n==null)return e;do{for(r=Object.getOwnPropertyNames(n),i=r.length;i-- >0;)o=r[i],(!s||s(o,n,e))&&!l[o]&&(e[o]=n[o],l[o]=!0);n=t!==!1&&Kt(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},dr=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const s=n.indexOf(e,t);return s!==-1&&s===t},fr=n=>{if(!n)return null;if(ge(n))return n;let e=n.length;if(!Xs(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},pr=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Kt(Uint8Array)),mr=(n,e)=>{const s=(n&&n[tt]).call(n);let r;for(;(r=s.next())&&!r.done;){const i=r.value;e.call(n,i[0],i[1])}},gr=(n,e)=>{let t;const s=[];for(;(t=n.exec(e))!==null;)s.push(t);return s},yr=J("HTMLFormElement"),br=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,r){return s.toUpperCase()+r}),gs=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),Er=J("RegExp"),Qs=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),s={};ke(t,(r,i)=>{let o;(o=e(r,i,n))!==!1&&(s[i]=o||r)}),Object.defineProperties(n,s)},Ar=n=>{Qs(n,(e,t)=>{if(H(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=n[t];if(H(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},vr=(n,e)=>{const t={},s=r=>{r.forEach(i=>{t[i]=!0})};return ge(n)?s(n):s(String(n).split(e)),t},Tr=()=>{},wr=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function Or(n){return!!(n&&H(n.append)&&n[Gs]==="FormData"&&n[tt])}const Sr=n=>{const e=new Array(10),t=(s,r)=>{if(Ne(s)){if(e.indexOf(s)>=0)return;if(Me(s))return s;if(!("toJSON"in s)){e[r]=s;const i=ge(s)?[]:{};return ke(s,(o,l)=>{const f=t(o,r+1);!Re(f)&&(i[l]=f)}),e[r]=void 0,i}}return s};return t(n,0)},Cr=J("AsyncFunction"),_r=n=>n&&(Ne(n)||H(n))&&H(n.then)&&H(n.catch),en=((n,e)=>n?setImmediate:e?((t,s)=>(re.addEventListener("message",({source:r,data:i})=>{r===re&&i===t&&s.length&&s.shift()()},!1),r=>{s.push(r),re.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",H(re.postMessage)),Rr=typeof queueMicrotask<"u"?queueMicrotask.bind(re):typeof process<"u"&&process.nextTick||en,xr=n=>n!=null&&H(n[tt]),c={isArray:ge,isArrayBuffer:Js,isBuffer:Me,isFormData:tr,isArrayBufferView:qn,isString:Wn,isNumber:Xs,isBoolean:Gn,isObject:Ne,isPlainObject:Ge,isEmptyObject:Jn,isReadableStream:nr,isRequest:rr,isResponse:ir,isHeaders:or,isUndefined:Re,isDate:Xn,isFile:Yn,isBlob:Zn,isRegExp:Er,isFunction:H,isStream:er,isURLSearchParams:sr,isTypedArray:pr,isFileList:Qn,forEach:ke,merge:xt,extend:lr,trim:ar,stripBOM:cr,inherits:ur,toFlatObject:hr,kindOf:st,kindOfTest:J,endsWith:dr,toArray:fr,forEachEntry:mr,matchAll:gr,isHTMLForm:yr,hasOwnProperty:gs,hasOwnProp:gs,reduceDescriptors:Qs,freezeMethods:Ar,toObjectSet:vr,toCamelCase:br,noop:Tr,toFiniteNumber:wr,findKey:Ys,global:re,isContextDefined:Zs,isSpecCompliantForm:Or,toJSONObject:Sr,isAsyncFn:Cr,isThenable:_r,setImmediate:en,asap:Rr,isIterable:xr};function A(n,e,t,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}c.inherits(A,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}});const tn=A.prototype,sn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{sn[n]={value:n}});Object.defineProperties(A,sn);Object.defineProperty(tn,"isAxiosError",{value:!0});A.from=(n,e,t,s,r,i)=>{const o=Object.create(tn);return c.toFlatObject(n,o,function(f){return f!==Error.prototype},l=>l!=="isAxiosError"),A.call(o,n.message,e,t,s,r),o.cause=n,o.name=n.name,i&&Object.assign(o,i),o};const Mr=null;function Mt(n){return c.isPlainObject(n)||c.isArray(n)}function nn(n){return c.endsWith(n,"[]")?n.slice(0,-2):n}function ys(n,e,t){return n?n.concat(e).map(function(r,i){return r=nn(r),!t&&i?"["+r+"]":r}).join(t?".":""):e}function Nr(n){return c.isArray(n)&&!n.some(Mt)}const kr=c.toFlatObject(c,{},null,function(e){return/^is[A-Z]/.test(e)});function rt(n,e,t){if(!c.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=c.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,y){return!c.isUndefined(y[E])});const s=t.metaTokens,r=t.visitor||h,i=t.dots,o=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(e);if(!c.isFunction(r))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(c.isDate(m))return m.toISOString();if(c.isBoolean(m))return m.toString();if(!f&&c.isBlob(m))throw new A("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(m)||c.isTypedArray(m)?f&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function h(m,E,y){let C=m;if(m&&!y&&typeof m=="object"){if(c.endsWith(E,"{}"))E=s?E:E.slice(0,-2),m=JSON.stringify(m);else if(c.isArray(m)&&Nr(m)||(c.isFileList(m)||c.endsWith(E,"[]"))&&(C=c.toArray(m)))return E=nn(E),C.forEach(function(_,w){!(c.isUndefined(_)||_===null)&&e.append(o===!0?ys([E],w,i):o===null?E:E+"[]",u(_))}),!1}return Mt(m)?!0:(e.append(ys(y,E,i),u(m)),!1)}const g=[],T=Object.assign(kr,{defaultVisitor:h,convertValue:u,isVisitable:Mt});function O(m,E){if(!c.isUndefined(m)){if(g.indexOf(m)!==-1)throw Error("Circular reference detected in "+E.join("."));g.push(m),c.forEach(m,function(C,R){(!(c.isUndefined(C)||C===null)&&r.call(e,C,c.isString(R)?R.trim():R,E,T))===!0&&O(C,E?E.concat(R):[R])}),g.pop()}}if(!c.isObject(n))throw new TypeError("data must be an object");return O(n),e}function bs(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function jt(n,e){this._pairs=[],n&&rt(n,this,e)}const rn=jt.prototype;rn.append=function(e,t){this._pairs.push([e,t])};rn.toString=function(e){const t=e?function(s){return e.call(this,s,bs)}:bs;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function Lr(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function on(n,e,t){if(!e)return n;const s=t&&t.encode||Lr;c.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let i;if(r?i=r(e,t):i=c.isURLSearchParams(e)?e.toString():new jt(e,t).toString(s),i){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class Es{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){c.forEach(this.handlers,function(s){s!==null&&e(s)})}}const an={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Fr=typeof URLSearchParams<"u"?URLSearchParams:jt,Ir=typeof FormData<"u"?FormData:null,Dr=typeof Blob<"u"?Blob:null,Br={isBrowser:!0,classes:{URLSearchParams:Fr,FormData:Ir,Blob:Dr},protocols:["http","https","file","blob","url","data"]},$t=typeof window<"u"&&typeof document<"u",Nt=typeof navigator=="object"&&navigator||void 0,Pr=$t&&(!Nt||["ReactNative","NativeScript","NS"].indexOf(Nt.product)<0),Ur=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Kr=$t&&window.location.href||"http://localhost",jr=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$t,hasStandardBrowserEnv:Pr,hasStandardBrowserWebWorkerEnv:Ur,navigator:Nt,origin:Kr},Symbol.toStringTag,{value:"Module"})),P={...jr,...Br};function $r(n,e){return rt(n,new P.classes.URLSearchParams,{visitor:function(t,s,r,i){return P.isNode&&c.isBuffer(t)?(this.append(s,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function Vr(n){return c.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Hr(n){const e={},t=Object.keys(n);let s;const r=t.length;let i;for(s=0;s<r;s++)i=t[s],e[i]=n[i];return e}function ln(n){function e(t,s,r,i){let o=t[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),f=i>=t.length;return o=!o&&c.isArray(r)?r.length:o,f?(c.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!l):((!r[o]||!c.isObject(r[o]))&&(r[o]=[]),e(t,s,r[o],i)&&c.isArray(r[o])&&(r[o]=Hr(r[o])),!l)}if(c.isFormData(n)&&c.isFunction(n.entries)){const t={};return c.forEachEntry(n,(s,r)=>{e(Vr(s),r,t,0)}),t}return null}function zr(n,e,t){if(c.isString(n))try{return(e||JSON.parse)(n),c.trim(n)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(n)}const Le={transitional:an,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",r=s.indexOf("application/json")>-1,i=c.isObject(e);if(i&&c.isHTMLForm(e)&&(e=new FormData(e)),c.isFormData(e))return r?JSON.stringify(ln(e)):e;if(c.isArrayBuffer(e)||c.isBuffer(e)||c.isStream(e)||c.isFile(e)||c.isBlob(e)||c.isReadableStream(e))return e;if(c.isArrayBufferView(e))return e.buffer;if(c.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return $r(e,this.formSerializer).toString();if((l=c.isFileList(e))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return rt(l?{"files[]":e}:e,f&&new f,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),zr(e)):e}],transformResponse:[function(e){const t=this.transitional||Le.transitional,s=t&&t.forcedJSONParsing,r=this.responseType==="json";if(c.isResponse(e)||c.isReadableStream(e))return e;if(e&&c.isString(e)&&(s&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?A.from(l,A.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:P.classes.FormData,Blob:P.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],n=>{Le.headers[n]={}});const qr=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Wr=n=>{const e={};let t,s,r;return n&&n.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!t||e[t]&&qr[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},As=Symbol("internals");function Te(n){return n&&String(n).trim().toLowerCase()}function Je(n){return n===!1||n==null?n:c.isArray(n)?n.map(Je):String(n)}function Gr(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(n);)e[s[1]]=s[2];return e}const Jr=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function vt(n,e,t,s,r){if(c.isFunction(s))return s.call(this,e,t);if(r&&(e=t),!!c.isString(e)){if(c.isString(s))return e.indexOf(s)!==-1;if(c.isRegExp(s))return s.test(e)}}function Xr(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function Yr(n,e){const t=c.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(n,s+t,{value:function(r,i,o){return this[s].call(this,e,r,i,o)},configurable:!0})})}let z=class{constructor(e){e&&this.set(e)}set(e,t,s){const r=this;function i(l,f,u){const h=Te(f);if(!h)throw new Error("header name must be a non-empty string");const g=c.findKey(r,h);(!g||r[g]===void 0||u===!0||u===void 0&&r[g]!==!1)&&(r[g||f]=Je(l))}const o=(l,f)=>c.forEach(l,(u,h)=>i(u,h,f));if(c.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(c.isString(e)&&(e=e.trim())&&!Jr(e))o(Wr(e),t);else if(c.isObject(e)&&c.isIterable(e)){let l={},f,u;for(const h of e){if(!c.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(f=l[u])?c.isArray(f)?[...f,h[1]]:[f,h[1]]:h[1]}o(l,t)}else e!=null&&i(t,e,s);return this}get(e,t){if(e=Te(e),e){const s=c.findKey(this,e);if(s){const r=this[s];if(!t)return r;if(t===!0)return Gr(r);if(c.isFunction(t))return t.call(this,r,s);if(c.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Te(e),e){const s=c.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||vt(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let r=!1;function i(o){if(o=Te(o),o){const l=c.findKey(s,o);l&&(!t||vt(s,s[l],l,t))&&(delete s[l],r=!0)}}return c.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let s=t.length,r=!1;for(;s--;){const i=t[s];(!e||vt(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const t=this,s={};return c.forEach(this,(r,i)=>{const o=c.findKey(s,i);if(o){t[o]=Je(r),delete t[i];return}const l=e?Xr(i):String(i).trim();l!==i&&delete t[i],t[l]=Je(r),s[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return c.forEach(this,(s,r)=>{s!=null&&s!==!1&&(t[r]=e&&c.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[As]=this[As]={accessors:{}}).accessors,r=this.prototype;function i(o){const l=Te(o);s[l]||(Yr(r,o),s[l]=!0)}return c.isArray(e)?e.forEach(i):i(e),this}};z.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(z.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(s){this[t]=s}}});c.freezeMethods(z);function Tt(n,e){const t=this||Le,s=e||t,r=z.from(s.headers);let i=s.data;return c.forEach(n,function(l){i=l.call(t,i,r.normalize(),e?e.status:void 0)}),r.normalize(),i}function cn(n){return!!(n&&n.__CANCEL__)}function ye(n,e,t){A.call(this,n??"canceled",A.ERR_CANCELED,e,t),this.name="CanceledError"}c.inherits(ye,A,{__CANCEL__:!0});function un(n,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?n(t):e(new A("Request failed with status code "+t.status,[A.ERR_BAD_REQUEST,A.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Zr(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Qr(n,e){n=n||10;const t=new Array(n),s=new Array(n);let r=0,i=0,o;return e=e!==void 0?e:1e3,function(f){const u=Date.now(),h=s[i];o||(o=u),t[r]=f,s[r]=u;let g=i,T=0;for(;g!==r;)T+=t[g++],g=g%n;if(r=(r+1)%n,r===i&&(i=(i+1)%n),u-o<e)return;const O=h&&u-h;return O?Math.round(T*1e3/O):void 0}}function ei(n,e){let t=0,s=1e3/e,r,i;const o=(u,h=Date.now())=>{t=h,r=null,i&&(clearTimeout(i),i=null),n(...u)};return[(...u)=>{const h=Date.now(),g=h-t;g>=s?o(u,h):(r=u,i||(i=setTimeout(()=>{i=null,o(r)},s-g)))},()=>r&&o(r)]}const Ze=(n,e,t=3)=>{let s=0;const r=Qr(50,250);return ei(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,f=o-s,u=r(f),h=o<=l;s=o;const g={loaded:o,total:l,progress:l?o/l:void 0,bytes:f,rate:u||void 0,estimated:u&&l&&h?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};n(g)},t)},vs=(n,e)=>{const t=n!=null;return[s=>e[0]({lengthComputable:t,total:n,loaded:s}),e[1]]},Ts=n=>(...e)=>c.asap(()=>n(...e)),ti=P.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,P.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(P.origin),P.navigator&&/(msie|trident)/i.test(P.navigator.userAgent)):()=>!0,si=P.hasStandardBrowserEnv?{write(n,e,t,s,r,i){const o=[n+"="+encodeURIComponent(e)];c.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),c.isString(s)&&o.push("path="+s),c.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ni(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function ri(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function hn(n,e,t){let s=!ni(e);return n&&(s||t==!1)?ri(n,e):e}const ws=n=>n instanceof z?{...n}:n;function ae(n,e){e=e||{};const t={};function s(u,h,g,T){return c.isPlainObject(u)&&c.isPlainObject(h)?c.merge.call({caseless:T},u,h):c.isPlainObject(h)?c.merge({},h):c.isArray(h)?h.slice():h}function r(u,h,g,T){if(c.isUndefined(h)){if(!c.isUndefined(u))return s(void 0,u,g,T)}else return s(u,h,g,T)}function i(u,h){if(!c.isUndefined(h))return s(void 0,h)}function o(u,h){if(c.isUndefined(h)){if(!c.isUndefined(u))return s(void 0,u)}else return s(void 0,h)}function l(u,h,g){if(g in e)return s(u,h);if(g in n)return s(void 0,u)}const f={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,h,g)=>r(ws(u),ws(h),g,!0)};return c.forEach(Object.keys({...n,...e}),function(h){const g=f[h]||r,T=g(n[h],e[h],h);c.isUndefined(T)&&g!==l||(t[h]=T)}),t}const dn=n=>{const e=ae({},n);let{data:t,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=z.from(o),e.url=on(hn(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let f;if(c.isFormData(t)){if(P.hasStandardBrowserEnv||P.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((f=o.getContentType())!==!1){const[u,...h]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...h].join("; "))}}if(P.hasStandardBrowserEnv&&(s&&c.isFunction(s)&&(s=s(e)),s||s!==!1&&ti(e.url))){const u=r&&i&&si.read(i);u&&o.set(r,u)}return e},ii=typeof XMLHttpRequest<"u",oi=ii&&function(n){return new Promise(function(t,s){const r=dn(n);let i=r.data;const o=z.from(r.headers).normalize();let{responseType:l,onUploadProgress:f,onDownloadProgress:u}=r,h,g,T,O,m;function E(){O&&O(),m&&m(),r.cancelToken&&r.cancelToken.unsubscribe(h),r.signal&&r.signal.removeEventListener("abort",h)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function C(){if(!y)return;const _=z.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:_,config:n,request:y};un(function(Z){t(Z),E()},function(Z){s(Z),E()},N),y=null}"onloadend"in y?y.onloadend=C:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(C)},y.onabort=function(){y&&(s(new A("Request aborted",A.ECONNABORTED,n,y)),y=null)},y.onerror=function(){s(new A("Network Error",A.ERR_NETWORK,n,y)),y=null},y.ontimeout=function(){let w=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const N=r.transitional||an;r.timeoutErrorMessage&&(w=r.timeoutErrorMessage),s(new A(w,N.clarifyTimeoutError?A.ETIMEDOUT:A.ECONNABORTED,n,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&c.forEach(o.toJSON(),function(w,N){y.setRequestHeader(N,w)}),c.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),l&&l!=="json"&&(y.responseType=r.responseType),u&&([T,m]=Ze(u,!0),y.addEventListener("progress",T)),f&&y.upload&&([g,O]=Ze(f),y.upload.addEventListener("progress",g),y.upload.addEventListener("loadend",O)),(r.cancelToken||r.signal)&&(h=_=>{y&&(s(!_||_.type?new ye(null,n,y):_),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(h),r.signal&&(r.signal.aborted?h():r.signal.addEventListener("abort",h)));const R=Zr(r.url);if(R&&P.protocols.indexOf(R)===-1){s(new A("Unsupported protocol "+R+":",A.ERR_BAD_REQUEST,n));return}y.send(i||null)})},ai=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let s=new AbortController,r;const i=function(u){if(!r){r=!0,l();const h=u instanceof Error?u:this.reason;s.abort(h instanceof A?h:new ye(h instanceof Error?h.message:h))}};let o=e&&setTimeout(()=>{o=null,i(new A(`timeout ${e} of ms exceeded`,A.ETIMEDOUT))},e);const l=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),n=null)};n.forEach(u=>u.addEventListener("abort",i));const{signal:f}=s;return f.unsubscribe=()=>c.asap(l),f}},li=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let s=0,r;for(;s<t;)r=s+e,yield n.slice(s,r),s=r},ci=async function*(n,e){for await(const t of ui(n))yield*li(t,e)},ui=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},Os=(n,e,t,s)=>{const r=ci(n,e);let i=0,o,l=f=>{o||(o=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:u,value:h}=await r.next();if(u){l(),f.close();return}let g=h.byteLength;if(t){let T=i+=g;t(T)}f.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(f){return l(f),r.return()}},{highWaterMark:2})},it=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",fn=it&&typeof ReadableStream=="function",hi=it&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),pn=(n,...e)=>{try{return!!n(...e)}catch{return!1}},di=fn&&pn(()=>{let n=!1;const e=new Request(P.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),Ss=64*1024,kt=fn&&pn(()=>c.isReadableStream(new Response("").body)),Qe={stream:kt&&(n=>n.body)};it&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Qe[e]&&(Qe[e]=c.isFunction(n[e])?t=>t[e]():(t,s)=>{throw new A(`Response type '${e}' is not supported`,A.ERR_NOT_SUPPORT,s)})})})(new Response);const fi=async n=>{if(n==null)return 0;if(c.isBlob(n))return n.size;if(c.isSpecCompliantForm(n))return(await new Request(P.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(c.isArrayBufferView(n)||c.isArrayBuffer(n))return n.byteLength;if(c.isURLSearchParams(n)&&(n=n+""),c.isString(n))return(await hi(n)).byteLength},pi=async(n,e)=>{const t=c.toFiniteNumber(n.getContentLength());return t??fi(e)},mi=it&&(async n=>{let{url:e,method:t,data:s,signal:r,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:f,responseType:u,headers:h,withCredentials:g="same-origin",fetchOptions:T}=dn(n);u=u?(u+"").toLowerCase():"text";let O=ai([r,i&&i.toAbortSignal()],o),m;const E=O&&O.unsubscribe&&(()=>{O.unsubscribe()});let y;try{if(f&&di&&t!=="get"&&t!=="head"&&(y=await pi(h,s))!==0){let N=new Request(e,{method:"POST",body:s,duplex:"half"}),q;if(c.isFormData(s)&&(q=N.headers.get("content-type"))&&h.setContentType(q),N.body){const[Z,le]=vs(y,Ze(Ts(f)));s=Os(N.body,Ss,Z,le)}}c.isString(g)||(g=g?"include":"omit");const C="credentials"in Request.prototype;m=new Request(e,{...T,signal:O,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:s,duplex:"half",credentials:C?g:void 0});let R=await fetch(m,T);const _=kt&&(u==="stream"||u==="response");if(kt&&(l||_&&E)){const N={};["status","statusText","headers"].forEach(Be=>{N[Be]=R[Be]});const q=c.toFiniteNumber(R.headers.get("content-length")),[Z,le]=l&&vs(q,Ze(Ts(l),!0))||[];R=new Response(Os(R.body,Ss,Z,()=>{le&&le(),E&&E()}),N)}u=u||"text";let w=await Qe[c.findKey(Qe,u)||"text"](R,n);return!_&&E&&E(),await new Promise((N,q)=>{un(N,q,{data:w,headers:z.from(R.headers),status:R.status,statusText:R.statusText,config:n,request:m})})}catch(C){throw E&&E(),C&&C.name==="TypeError"&&/Load failed|fetch/i.test(C.message)?Object.assign(new A("Network Error",A.ERR_NETWORK,n,m),{cause:C.cause||C}):A.from(C,C&&C.code,n,m)}}),Lt={http:Mr,xhr:oi,fetch:mi};c.forEach(Lt,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Cs=n=>`- ${n}`,gi=n=>c.isFunction(n)||n===null||n===!1,mn={getAdapter:n=>{n=c.isArray(n)?n:[n];const{length:e}=n;let t,s;const r={};for(let i=0;i<e;i++){t=n[i];let o;if(s=t,!gi(t)&&(s=Lt[(o=String(t)).toLowerCase()],s===void 0))throw new A(`Unknown adapter '${o}'`);if(s)break;r[o||"#"+i]=s}if(!s){const i=Object.entries(r).map(([l,f])=>`adapter ${l} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(Cs).join(`
`):" "+Cs(i[0]):"as no adapter specified";throw new A("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Lt};function wt(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new ye(null,n)}function _s(n){return wt(n),n.headers=z.from(n.headers),n.data=Tt.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),mn.getAdapter(n.adapter||Le.adapter)(n).then(function(s){return wt(n),s.data=Tt.call(n,n.transformResponse,s),s.headers=z.from(s.headers),s},function(s){return cn(s)||(wt(n),s&&s.response&&(s.response.data=Tt.call(n,n.transformResponse,s.response),s.response.headers=z.from(s.response.headers))),Promise.reject(s)})}const gn="1.11.0",ot={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{ot[n]=function(s){return typeof s===n||"a"+(e<1?"n ":" ")+n}});const Rs={};ot.transitional=function(e,t,s){function r(i,o){return"[Axios v"+gn+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,l)=>{if(e===!1)throw new A(r(o," has been removed"+(t?" in "+t:"")),A.ERR_DEPRECATED);return t&&!Rs[o]&&(Rs[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,o,l):!0}};ot.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function yi(n,e,t){if(typeof n!="object")throw new A("options must be an object",A.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let r=s.length;for(;r-- >0;){const i=s[r],o=e[i];if(o){const l=n[i],f=l===void 0||o(l,i,n);if(f!==!0)throw new A("option "+i+" must be "+f,A.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new A("Unknown option "+i,A.ERR_BAD_OPTION)}}const Xe={assertOptions:yi,validators:ot},Y=Xe.validators;let ie=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Es,response:new Es}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ae(this.defaults,t);const{transitional:s,paramsSerializer:r,headers:i}=t;s!==void 0&&Xe.assertOptions(s,{silentJSONParsing:Y.transitional(Y.boolean),forcedJSONParsing:Y.transitional(Y.boolean),clarifyTimeoutError:Y.transitional(Y.boolean)},!1),r!=null&&(c.isFunction(r)?t.paramsSerializer={serialize:r}:Xe.assertOptions(r,{encode:Y.function,serialize:Y.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Xe.assertOptions(t,{baseUrl:Y.spelling("baseURL"),withXsrfToken:Y.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&c.merge(i.common,i[t.method]);i&&c.forEach(["delete","get","head","post","put","patch","common"],m=>{delete i[m]}),t.headers=z.concat(o,i);const l=[];let f=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(t)===!1||(f=f&&E.synchronous,l.unshift(E.fulfilled,E.rejected))});const u=[];this.interceptors.response.forEach(function(E){u.push(E.fulfilled,E.rejected)});let h,g=0,T;if(!f){const m=[_s.bind(this),void 0];for(m.unshift(...l),m.push(...u),T=m.length,h=Promise.resolve(t);g<T;)h=h.then(m[g++],m[g++]);return h}T=l.length;let O=t;for(g=0;g<T;){const m=l[g++],E=l[g++];try{O=m(O)}catch(y){E.call(this,y);break}}try{h=_s.call(this,O)}catch(m){return Promise.reject(m)}for(g=0,T=u.length;g<T;)h=h.then(u[g++],u[g++]);return h}getUri(e){e=ae(this.defaults,e);const t=hn(e.baseURL,e.url,e.allowAbsoluteUrls);return on(t,e.params,e.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(e){ie.prototype[e]=function(t,s){return this.request(ae(s||{},{method:e,url:t,data:(s||{}).data}))}});c.forEach(["post","put","patch"],function(e){function t(s){return function(i,o,l){return this.request(ae(l||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ie.prototype[e]=t(),ie.prototype[e+"Form"]=t(!0)});let bi=class yn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(l=>{s.subscribe(l),i=l}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i,o,l){s.reason||(s.reason=new ye(i,o,l),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new yn(function(r){e=r}),cancel:e}}};function Ei(n){return function(t){return n.apply(null,t)}}function Ai(n){return c.isObject(n)&&n.isAxiosError===!0}const Ft={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ft).forEach(([n,e])=>{Ft[e]=n});function bn(n){const e=new ie(n),t=Ws(ie.prototype.request,e);return c.extend(t,ie.prototype,e,{allOwnKeys:!0}),c.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return bn(ae(n,r))},t}const M=bn(Le);M.Axios=ie;M.CanceledError=ye;M.CancelToken=bi;M.isCancel=cn;M.VERSION=gn;M.toFormData=rt;M.AxiosError=A;M.Cancel=M.CanceledError;M.all=function(e){return Promise.all(e)};M.spread=Ei;M.isAxiosError=Ai;M.mergeConfig=ae;M.AxiosHeaders=z;M.formToJSON=n=>ln(c.isHTMLForm(n)?new FormData(n):n);M.getAdapter=mn.getAdapter;M.HttpStatusCode=Ft;M.default=M;const{Axios:na,AxiosError:ra,CanceledError:ia,isCancel:oa,CancelToken:aa,VERSION:la,all:ca,Cancel:ua,isAxiosError:ha,spread:da,toFormData:fa,AxiosHeaders:pa,HttpStatusCode:ma,formToJSON:ga,getAdapter:ya,mergeConfig:ba}=M;window.axios=M;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";class vi{constructor(e,t,s){this.eventTarget=e,this.eventName=t,this.eventOptions=s,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const t=Ti(e);for(const s of this.bindings){if(t.immediatePropagationStopped)break;s.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,t)=>{const s=e.index,r=t.index;return s<r?-1:s>r?1:0})}}function Ti(n){if("immediatePropagationStopped"in n)return n;{const{stopImmediatePropagation:e}=n;return Object.assign(n,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}class wi{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,t)=>e.concat(Array.from(t.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,s={}){this.application.handleError(e,`Error ${t}`,s)}clearEventListenersForBinding(e){const t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:t,eventName:s,eventOptions:r}=e,i=this.fetchEventListenerMapForEventTarget(t),o=this.cacheKey(s,r);i.delete(o),i.size==0&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){const{eventTarget:t,eventName:s,eventOptions:r}=e;return this.fetchEventListener(t,s,r)}fetchEventListener(e,t,s){const r=this.fetchEventListenerMapForEventTarget(e),i=this.cacheKey(t,s);let o=r.get(i);return o||(o=this.createEventListener(e,t,s),r.set(i,o)),o}createEventListener(e,t,s){const r=new vi(e,t,s);return this.started&&r.connect(),r}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){const s=[e];return Object.keys(t).sort().forEach(r=>{s.push(`${t[r]?"":"!"}${r}`)}),s.join(":")}}const Oi={stop({event:n,value:e}){return e&&n.stopPropagation(),!0},prevent({event:n,value:e}){return e&&n.preventDefault(),!0},self({event:n,value:e,element:t}){return e?t===n.target:!0}},Si=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function Ci(n){const t=n.trim().match(Si)||[];let s=t[2],r=t[3];return r&&!["keydown","keyup","keypress"].includes(s)&&(s+=`.${r}`,r=""),{eventTarget:_i(t[4]),eventName:s,eventOptions:t[7]?Ri(t[7]):{},identifier:t[5],methodName:t[6],keyFilter:t[1]||r}}function _i(n){if(n=="window")return window;if(n=="document")return document}function Ri(n){return n.split(":").reduce((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)}),{})}function xi(n){if(n==window)return"window";if(n==document)return"document"}function Vt(n){return n.replace(/(?:[_-])([a-z0-9])/g,(e,t)=>t.toUpperCase())}function It(n){return Vt(n.replace(/--/g,"-").replace(/__/g,"_"))}function Fe(n){return n.charAt(0).toUpperCase()+n.slice(1)}function En(n){return n.replace(/([A-Z])/g,(e,t)=>`-${t.toLowerCase()}`)}function Mi(n){return n.match(/[^\s]+/g)||[]}function xs(n){return n!=null}function Dt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const Ms=["meta","ctrl","alt","shift"];class Ni{constructor(e,t,s,r){this.element=e,this.index=t,this.eventTarget=s.eventTarget||e,this.eventName=s.eventName||ki(e)||ze("missing event name"),this.eventOptions=s.eventOptions||{},this.identifier=s.identifier||ze("missing identifier"),this.methodName=s.methodName||ze("missing method name"),this.keyFilter=s.keyFilter||"",this.schema=r}static forToken(e,t){return new this(e.element,e.index,Ci(e.content),t)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;const t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;const s=t.filter(r=>!Ms.includes(r))[0];return s?(Dt(this.keyMappings,s)||ze(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[s].toLowerCase()!==e.key.toLowerCase()):!1}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;const t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}get params(){const e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:s,value:r}of Array.from(this.element.attributes)){const i=s.match(t),o=i&&i[1];o&&(e[Vt(o)]=Li(r))}return e}get eventTargetName(){return xi(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,t){const[s,r,i,o]=Ms.map(l=>t.includes(l));return e.metaKey!==s||e.ctrlKey!==r||e.altKey!==i||e.shiftKey!==o}}const Ns={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:n=>n.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function ki(n){const e=n.tagName.toLowerCase();if(e in Ns)return Ns[e](n)}function ze(n){throw new Error(n)}function Li(n){try{return JSON.parse(n)}catch{return n}}class Fi{constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){const t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:t}=this.action,{actionDescriptorFilters:s}=this.context.application,{controller:r}=this.context;let i=!0;for(const[o,l]of Object.entries(this.eventOptions))if(o in s){const f=s[o];i=i&&f({name:o,value:l,event:e,element:t,controller:r})}else continue;return i}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){const{target:t,currentTarget:s}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:s,action:this.methodName})}catch(r){const{identifier:i,controller:o,element:l,index:f}=this,u={identifier:i,controller:o,element:l,index:f,event:e};this.context.handleError(r,`invoking action "${this.action}"`,u)}}willBeInvokedByEvent(e){const t=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===t?!0:t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class An{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver(s=>this.processMutations(s))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(const t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(const t of Array.from(e)){const s=this.elementFromNode(t);s&&this.processTree(s,this.removeElement)}}processAddedNodes(e){for(const t of Array.from(e)){const s=this.elementFromNode(t);s&&this.elementIsActive(s)&&this.processTree(s,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(const s of this.matchElementsInTree(e))t.call(this,s)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class vn{constructor(e,t,s){this.attributeName=t,this.delegate=s,this.elementObserver=new An(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(this.selector));return t.concat(s)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}function Ii(n,e,t){Tn(n,e).add(t)}function Di(n,e,t){Tn(n,e).delete(t),Bi(n,e)}function Tn(n,e){let t=n.get(e);return t||(t=new Set,n.set(e,t)),t}function Bi(n,e){const t=n.get(e);t!=null&&t.size==0&&n.delete(e)}class oe{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((t,s)=>t.concat(Array.from(s)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((t,s)=>t+s.size,0)}add(e,t){Ii(this.valuesByKey,e,t)}delete(e,t){Di(this.valuesByKey,e,t)}has(e,t){const s=this.valuesByKey.get(e);return s!=null&&s.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(s=>s.has(e))}getValuesForKey(e){const t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([t,s])=>s.has(e)).map(([t,s])=>t)}}class Pi{constructor(e,t,s,r){this._selector=t,this.details=r,this.elementObserver=new An(e,this),this.delegate=s,this.matchesByElement=new oe}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const{selector:t}=this;if(t){const s=e.matches(t);return this.delegate.selectorMatchElement?s&&this.delegate.selectorMatchElement(e,this.details):s}else return!1}matchElementsInTree(e){const{selector:t}=this;if(t){const s=this.matchElement(e)?[e]:[],r=Array.from(e.querySelectorAll(t)).filter(i=>this.matchElement(i));return s.concat(r)}else return[]}elementMatched(e){const{selector:t}=this;t&&this.selectorMatched(e,t)}elementUnmatched(e){const t=this.matchesByElement.getKeysForValue(e);for(const s of t)this.selectorUnmatched(e,s)}elementAttributeChanged(e,t){const{selector:s}=this;if(s){const r=this.matchElement(e),i=this.matchesByElement.has(s,e);r&&!i?this.selectorMatched(e,s):!r&&i&&this.selectorUnmatched(e,s)}}selectorMatched(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}selectorUnmatched(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}}class Ui{constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(s=>this.processMutations(s))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){const t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){const s=this.delegate.getStringMapKeyForAttribute(e);if(s!=null){this.stringMap.has(e)||this.stringMapKeyAdded(s,e);const r=this.element.getAttribute(e);if(this.stringMap.get(e)!=r&&this.stringMapValueChanged(r,s,t),r==null){const i=this.stringMap.get(e);this.stringMap.delete(e),i&&this.stringMapKeyRemoved(s,e,i)}else this.stringMap.set(e,r)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,s){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,s)}stringMapKeyRemoved(e,t,s){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,s)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class wn{constructor(e,t,s){this.attributeObserver=new vn(e,t,this),this.delegate=s,this.tokensByElement=new oe}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[t,s]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(s)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(t=>this.tokenMatched(t))}tokensUnmatched(e){e.forEach(t=>this.tokenUnmatched(t))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const t=this.tokensByElement.getValuesForKey(e),s=this.readTokensForElement(e),r=ji(t,s).findIndex(([i,o])=>!$i(i,o));return r==-1?[[],[]]:[t.slice(r),s.slice(r)]}readTokensForElement(e){const t=this.attributeName,s=e.getAttribute(t)||"";return Ki(s,e,t)}}function Ki(n,e,t){return n.trim().split(/\s+/).filter(s=>s.length).map((s,r)=>({element:e,attributeName:t,content:s,index:r}))}function ji(n,e){const t=Math.max(n.length,e.length);return Array.from({length:t},(s,r)=>[n[r],e[r]])}function $i(n,e){return n&&e&&n.index==e.index&&n.content==e.content}class On{constructor(e,t,s){this.tokenListObserver=new wn(e,t,this),this.delegate=s,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:t}=e,{value:s}=this.fetchParseResultForToken(e);s&&(this.fetchValuesByTokenForElement(t).set(e,s),this.delegate.elementMatchedValue(t,s))}tokenUnmatched(e){const{element:t}=e,{value:s}=this.fetchParseResultForToken(e);s&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,s))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(t){return{error:t}}}}class Vi{constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new On(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const t=new Fi(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){const t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){const t=Ni.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}}class Hi{constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new Ui(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){const s=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,s.writer(this.receiver[e]),s.writer(s.defaultValue))}stringMapValueChanged(e,t,s){const r=this.valueDescriptorNameMap[t];e!==null&&(s===null&&(s=r.writer(r.defaultValue)),this.invokeChangedCallback(t,e,s))}stringMapKeyRemoved(e,t,s){const r=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,r.writer(this.receiver[e]),s):this.invokeChangedCallback(e,r.writer(r.defaultValue),s)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:t,defaultValue:s,writer:r}of this.valueDescriptors)s!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(t,r(s),void 0)}invokeChangedCallback(e,t,s){const r=`${e}Changed`,i=this.receiver[r];if(typeof i=="function"){const o=this.valueDescriptorNameMap[e];try{const l=o.reader(t);let f=s;s&&(f=o.reader(s)),i.call(this.receiver,l,f)}catch(l){throw l instanceof TypeError&&(l.message=`Stimulus Value "${this.context.identifier}.${o.name}" - ${l.message}`),l}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map(t=>e[t])}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach(t=>{const s=this.valueDescriptorMap[t];e[s.name]=s}),e}hasValue(e){const t=this.valueDescriptorNameMap[e],s=`has${Fe(t.name)}`;return this.receiver[s]}}class zi{constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new oe}start(){this.tokenListObserver||(this.tokenListObserver=new wn(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var s;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),(s=this.tokenListObserver)===null||s===void 0||s.pause(()=>this.delegate.targetConnected(e,t)))}disconnectTarget(e,t){var s;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),(s=this.tokenListObserver)===null||s===void 0||s.pause(()=>this.delegate.targetDisconnected(e,t)))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function Ie(n,e){const t=Sn(n);return Array.from(t.reduce((s,r)=>(Wi(r,e).forEach(i=>s.add(i)),s),new Set))}function qi(n,e){return Sn(n).reduce((s,r)=>(s.push(...Gi(r,e)),s),[])}function Sn(n){const e=[];for(;n;)e.push(n),n=Object.getPrototypeOf(n);return e.reverse()}function Wi(n,e){const t=n[e];return Array.isArray(t)?t:[]}function Gi(n,e){const t=n[e];return t?Object.keys(t).map(s=>[s,t[s]]):[]}class Ji{constructor(e,t){this.started=!1,this.context=e,this.delegate=t,this.outletsByName=new oe,this.outletElementsByName=new oe,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach(e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)}),this.started=!0,this.dependentContexts.forEach(e=>e.refresh()))}refresh(){this.selectorObserverMap.forEach(e=>e.refresh()),this.attributeObserverMap.forEach(e=>e.refresh())}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(e=>e.stop()),this.attributeObserverMap.clear())}selectorMatched(e,t,{outletName:s}){const r=this.getOutlet(e,s);r&&this.connectOutlet(r,e,s)}selectorUnmatched(e,t,{outletName:s}){const r=this.getOutletFromMap(e,s);r&&this.disconnectOutlet(r,e,s)}selectorMatchElement(e,{outletName:t}){const s=this.selector(t),r=this.hasOutlet(e,t),i=e.matches(`[${this.schema.controllerAttribute}~=${t}]`);return s?r&&i&&e.matches(s):!1}elementMatchedAttribute(e,t){const s=this.getOutletNameFromOutletAttributeName(t);s&&this.updateSelectorObserverForOutlet(s)}elementAttributeValueChanged(e,t){const s=this.getOutletNameFromOutletAttributeName(t);s&&this.updateSelectorObserverForOutlet(s)}elementUnmatchedAttribute(e,t){const s=this.getOutletNameFromOutletAttributeName(t);s&&this.updateSelectorObserverForOutlet(s)}connectOutlet(e,t,s){var r;this.outletElementsByName.has(s,t)||(this.outletsByName.add(s,e),this.outletElementsByName.add(s,t),(r=this.selectorObserverMap.get(s))===null||r===void 0||r.pause(()=>this.delegate.outletConnected(e,t,s)))}disconnectOutlet(e,t,s){var r;this.outletElementsByName.has(s,t)&&(this.outletsByName.delete(s,e),this.outletElementsByName.delete(s,t),(r=this.selectorObserverMap.get(s))===null||r===void 0||r.pause(()=>this.delegate.outletDisconnected(e,t,s)))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const t of this.outletElementsByName.getValuesForKey(e))for(const s of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(s,t,e)}updateSelectorObserverForOutlet(e){const t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}setupSelectorObserverForOutlet(e){const t=this.selector(e),s=new Pi(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,s),s.start()}setupAttributeObserverForOutlet(e){const t=this.attributeNameForOutletName(e),s=new vn(this.scope.element,t,this);this.attributeObserverMap.set(e,s),s.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find(t=>this.attributeNameForOutletName(t)===e)}get outletDependencies(){const e=new oe;return this.router.modules.forEach(t=>{const s=t.definition.controllerConstructor;Ie(s,"outlets").forEach(i=>e.add(i,t.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter(t=>e.includes(t.identifier))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find(s=>s.element===e)}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class Xi{constructor(e,t){this.logDebugActivity=(s,r={})=>{const{identifier:i,controller:o,element:l}=this;r=Object.assign({identifier:i,controller:o,element:l},r),this.application.logDebugActivity(this.identifier,s,r)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new Vi(this,this.dispatcher),this.valueObserver=new Hi(this,this.controller),this.targetObserver=new zi(this,this),this.outletObserver=new Ji(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(s){this.handleError(s,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,s={}){const{identifier:r,controller:i,element:o}=this;s=Object.assign({identifier:r,controller:i,element:o},s),this.application.handleError(e,`Error ${t}`,s)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,s){this.invokeControllerMethod(`${It(s)}OutletConnected`,e,t)}outletDisconnected(e,t,s){this.invokeControllerMethod(`${It(s)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){const s=this.controller;typeof s[e]=="function"&&s[e](...t)}}function Yi(n){return Zi(n,Qi(n))}function Zi(n,e){const t=no(n),s=eo(n.prototype,e);return Object.defineProperties(t.prototype,s),t}function Qi(n){return Ie(n,"blessings").reduce((t,s)=>{const r=s(n);for(const i in r){const o=t[i]||{};t[i]=Object.assign(o,r[i])}return t},{})}function eo(n,e){return so(e).reduce((t,s)=>{const r=to(n,e,s);return r&&Object.assign(t,{[s]:r}),t},{})}function to(n,e,t){const s=Object.getOwnPropertyDescriptor(n,t);if(!(s&&"value"in s)){const i=Object.getOwnPropertyDescriptor(e,t).value;return s&&(i.get=s.get||i.get,i.set=s.set||i.set),i}}const so=typeof Object.getOwnPropertySymbols=="function"?n=>[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)]:Object.getOwnPropertyNames,no=(()=>{function n(t){function s(){return Reflect.construct(t,arguments,new.target)}return s.prototype=Object.create(t.prototype,{constructor:{value:s}}),Reflect.setPrototypeOf(s,t),s}function e(){const s=n(function(){this.a.call(this)});return s.prototype.a=function(){},new s}try{return e(),n}catch{return s=>class extends s{}}})();function ro(n){return{identifier:n.identifier,controllerConstructor:Yi(n.controllerConstructor)}}class io{constructor(e,t){this.application=e,this.definition=ro(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){const t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new Xi(this,e),this.contextsByScope.set(e,t)),t}}class oo{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){const t=this.data.get(this.getDataKey(e))||"";return Mi(t)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class ao{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){const s=this.getAttributeNameForKey(e);return this.element.setAttribute(s,t),this.get(e)}has(e){const t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){const t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${En(e)}`}}class lo{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,s){let r=this.warnedKeysByObject.get(e);r||(r=new Set,this.warnedKeysByObject.set(e,r)),r.has(t)||(r.add(t),this.logger.warn(s,e))}}function Bt(n,e){return`[${n}~="${e}"]`}class co{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,s)=>t||this.findTarget(s)||this.findLegacyTarget(s),void 0)}findAll(...e){return e.reduce((t,s)=>[...t,...this.findAllTargets(s),...this.findAllLegacyTargets(s)],[])}findTarget(e){const t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){const t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){const t=this.schema.targetAttributeForScope(this.identifier);return Bt(t,e)}findLegacyTarget(e){const t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){const t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map(s=>this.deprecate(s,e))}getLegacySelectorForTargetName(e){const t=`${this.identifier}.${e}`;return Bt(this.schema.targetAttribute,t)}deprecate(e,t){if(e){const{identifier:s}=this,r=this.schema.targetAttribute,i=this.schema.targetAttributeForScope(s);this.guide.warn(e,`target:${t}`,`Please replace ${r}="${s}.${t}" with ${i}="${t}". The ${r} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class uo{constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,s)=>t||this.findOutlet(s),void 0)}findAll(...e){return e.reduce((t,s)=>[...t,...this.findAllOutlets(s)],[])}getSelectorForOutletName(e){const t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){const t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){const t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter(r=>this.matchesElement(r,e,t))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter(r=>this.matchesElement(r,e,t))}matchesElement(e,t,s){const r=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&r.split(" ").includes(s)}}class Ht{constructor(e,t,s,r){this.targets=new co(this),this.classes=new oo(this),this.data=new ao(this),this.containsElement=i=>i.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=s,this.guide=new lo(r),this.outlets=new uo(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return Bt(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new Ht(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class ho{constructor(e,t,s){this.element=e,this.schema=t,this.delegate=s,this.valueListObserver=new On(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:t,content:s}=e;return this.parseValueForElementAndIdentifier(t,s)}parseValueForElementAndIdentifier(e,t){const s=this.fetchScopesByIdentifierForElement(e);let r=s.get(t);return r||(r=this.delegate.createScopeForElementAndIdentifier(e,t),s.set(t,r)),r}elementMatchedValue(e,t){const s=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,s),s==1&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){const s=this.scopeReferenceCounts.get(t);s&&(this.scopeReferenceCounts.set(t,s-1),s==1&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}class fo{constructor(e){this.application=e,this.scopeObserver=new ho(this.element,this.schema,this),this.scopesByIdentifier=new oe,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,t)=>e.concat(t.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const t=new io(this.application,e);this.connectModule(t);const s=e.controllerConstructor.afterLoad;s&&s.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){const t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){const s=this.modulesByIdentifier.get(t);if(s)return s.contexts.find(r=>r.element==e)}proposeToConnectScopeForElementAndIdentifier(e,t){const s=this.scopeObserver.parseValueForElementAndIdentifier(e,t);s?this.scopeObserver.elementMatchedValue(s.element,s):console.error(`Couldn't find or create scope for identifier: "${t}" and element:`,e)}handleError(e,t,s){this.application.handleError(e,t,s)}createScopeForElementAndIdentifier(e,t){return new Ht(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(s=>e.connectContextForScope(s))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(s=>e.disconnectContextForScope(s))}}const po={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:n=>`data-${n}-target`,outletAttributeForScope:(n,e)=>`data-${n}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},ks("abcdefghijklmnopqrstuvwxyz".split("").map(n=>[n,n]))),ks("0123456789".split("").map(n=>[n,n])))};function ks(n){return n.reduce((e,[t,s])=>Object.assign(Object.assign({},e),{[t]:s}),{})}class mo{constructor(e=document.documentElement,t=po){this.logger=console,this.debug=!1,this.logDebugActivity=(s,r,i={})=>{this.debug&&this.logFormattedMessage(s,r,i)},this.element=e,this.schema=t,this.dispatcher=new wi(this),this.router=new fo(this),this.actionDescriptorFilters=Object.assign({},Oi)}static start(e,t){const s=new this(e,t);return s.start(),s}async start(){await go(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(r=>{r.controllerConstructor.shouldLoad&&this.router.loadDefinition(r)})}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(r=>this.router.unloadIdentifier(r))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,t){const s=this.router.getContextForElementAndIdentifier(e,t);return s?s.controller:null}handleError(e,t,s){var r;this.logger.error(`%s

%o

%o`,t,e,s),(r=window.onerror)===null||r===void 0||r.call(window,t,"",0,0,e)}logFormattedMessage(e,t,s={}){s=Object.assign({application:this},s),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},s)),this.logger.groupEnd()}}function go(){return new Promise(n=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>n()):n()})}function yo(n){return Ie(n,"classes").reduce((t,s)=>Object.assign(t,bo(s)),{})}function bo(n){return{[`${n}Class`]:{get(){const{classes:e}=this;if(e.has(n))return e.get(n);{const t=e.getAttributeName(n);throw new Error(`Missing attribute "${t}"`)}}},[`${n}Classes`]:{get(){return this.classes.getAll(n)}},[`has${Fe(n)}Class`]:{get(){return this.classes.has(n)}}}}function Eo(n){return Ie(n,"outlets").reduce((t,s)=>Object.assign(t,Ao(s)),{})}function Ls(n,e,t){return n.application.getControllerForElementAndIdentifier(e,t)}function Fs(n,e,t){let s=Ls(n,e,t);if(s||(n.application.router.proposeToConnectScopeForElementAndIdentifier(e,t),s=Ls(n,e,t),s))return s}function Ao(n){const e=It(n);return{[`${e}Outlet`]:{get(){const t=this.outlets.find(n),s=this.outlets.getSelectorForOutletName(n);if(t){const r=Fs(this,t,n);if(r)return r;throw new Error(`The provided outlet element is missing an outlet controller "${n}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${n}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${s}".`)}},[`${e}Outlets`]:{get(){const t=this.outlets.findAll(n);return t.length>0?t.map(s=>{const r=Fs(this,s,n);if(r)return r;console.warn(`The provided outlet element is missing an outlet controller "${n}" instance for host controller "${this.identifier}"`,s)}).filter(s=>s):[]}},[`${e}OutletElement`]:{get(){const t=this.outlets.find(n),s=this.outlets.getSelectorForOutletName(n);if(t)return t;throw new Error(`Missing outlet element "${n}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${s}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(n)}},[`has${Fe(e)}Outlet`]:{get(){return this.outlets.has(n)}}}}function vo(n){return Ie(n,"targets").reduce((t,s)=>Object.assign(t,To(s)),{})}function To(n){return{[`${n}Target`]:{get(){const e=this.targets.find(n);if(e)return e;throw new Error(`Missing target element "${n}" for "${this.identifier}" controller`)}},[`${n}Targets`]:{get(){return this.targets.findAll(n)}},[`has${Fe(n)}Target`]:{get(){return this.targets.has(n)}}}}function wo(n){const e=qi(n,"values"),t={valueDescriptorMap:{get(){return e.reduce((s,r)=>{const i=Cn(r,this.identifier),o=this.data.getAttributeNameForKey(i.key);return Object.assign(s,{[o]:i})},{})}}};return e.reduce((s,r)=>Object.assign(s,Oo(r)),t)}function Oo(n,e){const t=Cn(n,e),{key:s,name:r,reader:i,writer:o}=t;return{[r]:{get(){const l=this.data.get(s);return l!==null?i(l):t.defaultValue},set(l){l===void 0?this.data.delete(s):this.data.set(s,o(l))}},[`has${Fe(r)}`]:{get(){return this.data.has(s)||t.hasCustomDefaultValue}}}}function Cn([n,e],t){return Ro({controller:t,token:n,typeDefinition:e})}function et(n){switch(n){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function xe(n){switch(typeof n){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(n))return"array";if(Object.prototype.toString.call(n)==="[object Object]")return"object"}function So(n){const{controller:e,token:t,typeObject:s}=n,r=xs(s.type),i=xs(s.default),o=r&&i,l=r&&!i,f=!r&&i,u=et(s.type),h=xe(n.typeObject.default);if(l)return u;if(f)return h;if(u!==h){const g=e?`${e}.${t}`:t;throw new Error(`The specified default value for the Stimulus Value "${g}" must match the defined type "${u}". The provided default value of "${s.default}" is of type "${h}".`)}if(o)return u}function Co(n){const{controller:e,token:t,typeDefinition:s}=n,i=So({controller:e,token:t,typeObject:s}),o=xe(s),l=et(s),f=i||o||l;if(f)return f;const u=e?`${e}.${s}`:t;throw new Error(`Unknown value type "${u}" for "${t}" value`)}function _o(n){const e=et(n);if(e)return Is[e];const t=Dt(n,"default"),s=Dt(n,"type"),r=n;if(t)return r.default;if(s){const{type:i}=r,o=et(i);if(o)return Is[o]}return n}function Ro(n){const{token:e,typeDefinition:t}=n,s=`${En(e)}-value`,r=Co(n);return{type:r,key:s,name:Vt(s),get defaultValue(){return _o(t)},get hasCustomDefaultValue(){return xe(t)!==void 0},reader:xo[r],writer:Ds[r]||Ds.default}}const Is={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},xo={array(n){const e=JSON.parse(n);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${n}" of type "${xe(e)}"`);return e},boolean(n){return!(n=="0"||String(n).toLowerCase()=="false")},number(n){return Number(n.replace(/_/g,""))},object(n){const e=JSON.parse(n);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${n}" of type "${xe(e)}"`);return e},string(n){return n}},Ds={default:Mo,array:Bs,object:Bs};function Bs(n){return JSON.stringify(n)}function Mo(n){return`${n}`}class De{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:s={},prefix:r=this.identifier,bubbles:i=!0,cancelable:o=!0}={}){const l=r?`${r}:${e}`:e,f=new CustomEvent(l,{detail:s,bubbles:i,cancelable:o});return t.dispatchEvent(f),f}}De.blessings=[yo,vo,wo,Eo];De.targets=[];De.outlets=[];De.values={};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:_n,setPrototypeOf:Ps,isFrozen:No,getPrototypeOf:ko,getOwnPropertyDescriptor:Lo}=Object;let{freeze:j,seal:W,create:Rn}=Object,{apply:Pt,construct:Ut}=typeof Reflect<"u"&&Reflect;j||(j=function(e){return e});W||(W=function(e){return e});Pt||(Pt=function(e,t,s){return e.apply(t,s)});Ut||(Ut=function(e,t){return new e(...t)});const qe=$(Array.prototype.forEach),Fo=$(Array.prototype.lastIndexOf),Us=$(Array.prototype.pop),we=$(Array.prototype.push),Io=$(Array.prototype.splice),Ye=$(String.prototype.toLowerCase),Ot=$(String.prototype.toString),Ks=$(String.prototype.match),Oe=$(String.prototype.replace),Do=$(String.prototype.indexOf),Bo=$(String.prototype.trim),G=$(Object.prototype.hasOwnProperty),K=$(RegExp.prototype.test),Se=Po(TypeError);function $(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return Pt(n,e,s)}}function Po(n){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Ut(n,t)}}function v(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ye;Ps&&Ps(n,null);let s=e.length;for(;s--;){let r=e[s];if(typeof r=="string"){const i=t(r);i!==r&&(No(e)||(e[s]=i),r=i)}n[r]=!0}return n}function Uo(n){for(let e=0;e<n.length;e++)G(n,e)||(n[e]=null);return n}function se(n){const e=Rn(null);for(const[t,s]of _n(n))G(n,t)&&(Array.isArray(s)?e[t]=Uo(s):s&&typeof s=="object"&&s.constructor===Object?e[t]=se(s):e[t]=s);return e}function Ce(n,e){for(;n!==null;){const s=Lo(n,e);if(s){if(s.get)return $(s.get);if(typeof s.value=="function")return $(s.value)}n=ko(n)}function t(){return null}return t}const js=j(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),St=j(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ct=j(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ko=j(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_t=j(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),jo=j(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$s=j(["#text"]),Vs=j(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Rt=j(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Hs=j(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),We=j(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$o=W(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Vo=W(/<%[\w\W]*|[\w\W]*%>/gm),Ho=W(/\$\{[\w\W]*/gm),zo=W(/^data-[\-\w.\u00B7-\uFFFF]+$/),qo=W(/^aria-[\-\w]+$/),xn=W(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Wo=W(/^(?:\w+script|data):/i),Go=W(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Mn=W(/^html$/i),Jo=W(/^[a-z][.\w]*(-[.\w]+)+$/i);var zs=Object.freeze({__proto__:null,ARIA_ATTR:qo,ATTR_WHITESPACE:Go,CUSTOM_ELEMENT:Jo,DATA_ATTR:zo,DOCTYPE_NAME:Mn,ERB_EXPR:Vo,IS_ALLOWED_URI:xn,IS_SCRIPT_OR_DATA:Wo,MUSTACHE_EXPR:$o,TMPLIT_EXPR:Ho});const _e={element:1,text:3,progressingInstruction:7,comment:8,document:9},Xo=function(){return typeof window>"u"?null:window},Yo=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(s=t.getAttribute(r));const i="dompurify"+(s?"#"+s:"");try{return e.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},qs=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Nn(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xo();const e=b=>Nn(b);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==_e.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const s=t,r=s.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:f,NodeFilter:u,NamedNodeMap:h=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:g,DOMParser:T,trustedTypes:O}=n,m=f.prototype,E=Ce(m,"cloneNode"),y=Ce(m,"remove"),C=Ce(m,"nextSibling"),R=Ce(m,"childNodes"),_=Ce(m,"parentNode");if(typeof o=="function"){const b=t.createElement("template");b.content&&b.content.ownerDocument&&(t=b.content.ownerDocument)}let w,N="";const{implementation:q,createNodeIterator:Z,createDocumentFragment:le,getElementsByTagName:Be}=t,{importNode:kn}=s;let U=qs();e.isSupported=typeof _n=="function"&&typeof _=="function"&&q&&q.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:at,ERB_EXPR:lt,TMPLIT_EXPR:ct,DATA_ATTR:Ln,ARIA_ATTR:Fn,IS_SCRIPT_OR_DATA:In,ATTR_WHITESPACE:zt,CUSTOM_ELEMENT:Dn}=zs;let{IS_ALLOWED_URI:qt}=zs,L=null;const Wt=v({},[...js,...St,...Ct,..._t,...$s]);let I=null;const Gt=v({},[...Vs,...Rt,...Hs,...We]);let x=Object.seal(Rn(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),be=null,ut=null,Jt=!0,ht=!0,Xt=!1,Yt=!0,ce=!1,Pe=!0,ne=!1,dt=!1,ft=!1,ue=!1,Ue=!1,Ke=!1,Zt=!0,Qt=!1;const Bn="user-content-";let pt=!0,Ee=!1,he={},de=null;const es=v({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ts=null;const ss=v({},["audio","video","img","source","image","track"]);let mt=null;const ns=v({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),je="http://www.w3.org/1998/Math/MathML",$e="http://www.w3.org/2000/svg",Q="http://www.w3.org/1999/xhtml";let fe=Q,gt=!1,yt=null;const Pn=v({},[je,$e,Q],Ot);let Ve=v({},["mi","mo","mn","ms","mtext"]),He=v({},["annotation-xml"]);const Un=v({},["title","style","font","a","script"]);let Ae=null;const Kn=["application/xhtml+xml","text/html"],jn="text/html";let F=null,pe=null;const $n=t.createElement("form"),rs=function(a){return a instanceof RegExp||a instanceof Function},bt=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(pe&&pe===a)){if((!a||typeof a!="object")&&(a={}),a=se(a),Ae=Kn.indexOf(a.PARSER_MEDIA_TYPE)===-1?jn:a.PARSER_MEDIA_TYPE,F=Ae==="application/xhtml+xml"?Ot:Ye,L=G(a,"ALLOWED_TAGS")?v({},a.ALLOWED_TAGS,F):Wt,I=G(a,"ALLOWED_ATTR")?v({},a.ALLOWED_ATTR,F):Gt,yt=G(a,"ALLOWED_NAMESPACES")?v({},a.ALLOWED_NAMESPACES,Ot):Pn,mt=G(a,"ADD_URI_SAFE_ATTR")?v(se(ns),a.ADD_URI_SAFE_ATTR,F):ns,ts=G(a,"ADD_DATA_URI_TAGS")?v(se(ss),a.ADD_DATA_URI_TAGS,F):ss,de=G(a,"FORBID_CONTENTS")?v({},a.FORBID_CONTENTS,F):es,be=G(a,"FORBID_TAGS")?v({},a.FORBID_TAGS,F):se({}),ut=G(a,"FORBID_ATTR")?v({},a.FORBID_ATTR,F):se({}),he=G(a,"USE_PROFILES")?a.USE_PROFILES:!1,Jt=a.ALLOW_ARIA_ATTR!==!1,ht=a.ALLOW_DATA_ATTR!==!1,Xt=a.ALLOW_UNKNOWN_PROTOCOLS||!1,Yt=a.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ce=a.SAFE_FOR_TEMPLATES||!1,Pe=a.SAFE_FOR_XML!==!1,ne=a.WHOLE_DOCUMENT||!1,ue=a.RETURN_DOM||!1,Ue=a.RETURN_DOM_FRAGMENT||!1,Ke=a.RETURN_TRUSTED_TYPE||!1,ft=a.FORCE_BODY||!1,Zt=a.SANITIZE_DOM!==!1,Qt=a.SANITIZE_NAMED_PROPS||!1,pt=a.KEEP_CONTENT!==!1,Ee=a.IN_PLACE||!1,qt=a.ALLOWED_URI_REGEXP||xn,fe=a.NAMESPACE||Q,Ve=a.MATHML_TEXT_INTEGRATION_POINTS||Ve,He=a.HTML_INTEGRATION_POINTS||He,x=a.CUSTOM_ELEMENT_HANDLING||{},a.CUSTOM_ELEMENT_HANDLING&&rs(a.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=a.CUSTOM_ELEMENT_HANDLING.tagNameCheck),a.CUSTOM_ELEMENT_HANDLING&&rs(a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),a.CUSTOM_ELEMENT_HANDLING&&typeof a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ce&&(ht=!1),Ue&&(ue=!0),he&&(L=v({},$s),I=[],he.html===!0&&(v(L,js),v(I,Vs)),he.svg===!0&&(v(L,St),v(I,Rt),v(I,We)),he.svgFilters===!0&&(v(L,Ct),v(I,Rt),v(I,We)),he.mathMl===!0&&(v(L,_t),v(I,Hs),v(I,We))),a.ADD_TAGS&&(L===Wt&&(L=se(L)),v(L,a.ADD_TAGS,F)),a.ADD_ATTR&&(I===Gt&&(I=se(I)),v(I,a.ADD_ATTR,F)),a.ADD_URI_SAFE_ATTR&&v(mt,a.ADD_URI_SAFE_ATTR,F),a.FORBID_CONTENTS&&(de===es&&(de=se(de)),v(de,a.FORBID_CONTENTS,F)),pt&&(L["#text"]=!0),ne&&v(L,["html","head","body"]),L.table&&(v(L,["tbody"]),delete be.tbody),a.TRUSTED_TYPES_POLICY){if(typeof a.TRUSTED_TYPES_POLICY.createHTML!="function")throw Se('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof a.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Se('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=a.TRUSTED_TYPES_POLICY,N=w.createHTML("")}else w===void 0&&(w=Yo(O,r)),w!==null&&typeof N=="string"&&(N=w.createHTML(""));j&&j(a),pe=a}},is=v({},[...St,...Ct,...Ko]),os=v({},[..._t,...jo]),Vn=function(a){let d=_(a);(!d||!d.tagName)&&(d={namespaceURI:fe,tagName:"template"});const p=Ye(a.tagName),S=Ye(d.tagName);return yt[a.namespaceURI]?a.namespaceURI===$e?d.namespaceURI===Q?p==="svg":d.namespaceURI===je?p==="svg"&&(S==="annotation-xml"||Ve[S]):!!is[p]:a.namespaceURI===je?d.namespaceURI===Q?p==="math":d.namespaceURI===$e?p==="math"&&He[S]:!!os[p]:a.namespaceURI===Q?d.namespaceURI===$e&&!He[S]||d.namespaceURI===je&&!Ve[S]?!1:!os[p]&&(Un[p]||!is[p]):!!(Ae==="application/xhtml+xml"&&yt[a.namespaceURI]):!1},X=function(a){we(e.removed,{element:a});try{_(a).removeChild(a)}catch{y(a)}},me=function(a,d){try{we(e.removed,{attribute:d.getAttributeNode(a),from:d})}catch{we(e.removed,{attribute:null,from:d})}if(d.removeAttribute(a),a==="is")if(ue||Ue)try{X(d)}catch{}else try{d.setAttribute(a,"")}catch{}},as=function(a){let d=null,p=null;if(ft)a="<remove></remove>"+a;else{const k=Ks(a,/^[\r\n\t ]+/);p=k&&k[0]}Ae==="application/xhtml+xml"&&fe===Q&&(a='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+a+"</body></html>");const S=w?w.createHTML(a):a;if(fe===Q)try{d=new T().parseFromString(S,Ae)}catch{}if(!d||!d.documentElement){d=q.createDocument(fe,"template",null);try{d.documentElement.innerHTML=gt?N:S}catch{}}const D=d.body||d.documentElement;return a&&p&&D.insertBefore(t.createTextNode(p),D.childNodes[0]||null),fe===Q?Be.call(d,ne?"html":"body")[0]:ne?d.documentElement:D},ls=function(a){return Z.call(a.ownerDocument||a,a,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Et=function(a){return a instanceof g&&(typeof a.nodeName!="string"||typeof a.textContent!="string"||typeof a.removeChild!="function"||!(a.attributes instanceof h)||typeof a.removeAttribute!="function"||typeof a.setAttribute!="function"||typeof a.namespaceURI!="string"||typeof a.insertBefore!="function"||typeof a.hasChildNodes!="function")},cs=function(a){return typeof l=="function"&&a instanceof l};function ee(b,a,d){qe(b,p=>{p.call(e,a,d,pe)})}const us=function(a){let d=null;if(ee(U.beforeSanitizeElements,a,null),Et(a))return X(a),!0;const p=F(a.nodeName);if(ee(U.uponSanitizeElement,a,{tagName:p,allowedTags:L}),Pe&&a.hasChildNodes()&&!cs(a.firstElementChild)&&K(/<[/\w!]/g,a.innerHTML)&&K(/<[/\w!]/g,a.textContent)||a.nodeType===_e.progressingInstruction||Pe&&a.nodeType===_e.comment&&K(/<[/\w]/g,a.data))return X(a),!0;if(!L[p]||be[p]){if(!be[p]&&ds(p)&&(x.tagNameCheck instanceof RegExp&&K(x.tagNameCheck,p)||x.tagNameCheck instanceof Function&&x.tagNameCheck(p)))return!1;if(pt&&!de[p]){const S=_(a)||a.parentNode,D=R(a)||a.childNodes;if(D&&S){const k=D.length;for(let V=k-1;V>=0;--V){const te=E(D[V],!0);te.__removalCount=(a.__removalCount||0)+1,S.insertBefore(te,C(a))}}}return X(a),!0}return a instanceof f&&!Vn(a)||(p==="noscript"||p==="noembed"||p==="noframes")&&K(/<\/no(script|embed|frames)/i,a.innerHTML)?(X(a),!0):(ce&&a.nodeType===_e.text&&(d=a.textContent,qe([at,lt,ct],S=>{d=Oe(d,S," ")}),a.textContent!==d&&(we(e.removed,{element:a.cloneNode()}),a.textContent=d)),ee(U.afterSanitizeElements,a,null),!1)},hs=function(a,d,p){if(Zt&&(d==="id"||d==="name")&&(p in t||p in $n))return!1;if(!(ht&&!ut[d]&&K(Ln,d))){if(!(Jt&&K(Fn,d))){if(!I[d]||ut[d]){if(!(ds(a)&&(x.tagNameCheck instanceof RegExp&&K(x.tagNameCheck,a)||x.tagNameCheck instanceof Function&&x.tagNameCheck(a))&&(x.attributeNameCheck instanceof RegExp&&K(x.attributeNameCheck,d)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(d))||d==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&K(x.tagNameCheck,p)||x.tagNameCheck instanceof Function&&x.tagNameCheck(p))))return!1}else if(!mt[d]){if(!K(qt,Oe(p,zt,""))){if(!((d==="src"||d==="xlink:href"||d==="href")&&a!=="script"&&Do(p,"data:")===0&&ts[a])){if(!(Xt&&!K(In,Oe(p,zt,"")))){if(p)return!1}}}}}}return!0},ds=function(a){return a!=="annotation-xml"&&Ks(a,Dn)},fs=function(a){ee(U.beforeSanitizeAttributes,a,null);const{attributes:d}=a;if(!d||Et(a))return;const p={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I,forceKeepAttr:void 0};let S=d.length;for(;S--;){const D=d[S],{name:k,namespaceURI:V,value:te}=D,ve=F(k),At=te;let B=k==="value"?At:Bo(At);if(p.attrName=ve,p.attrValue=B,p.keepAttr=!0,p.forceKeepAttr=void 0,ee(U.uponSanitizeAttribute,a,p),B=p.attrValue,Qt&&(ve==="id"||ve==="name")&&(me(k,a),B=Bn+B),Pe&&K(/((--!?|])>)|<\/(style|title)/i,B)){me(k,a);continue}if(p.forceKeepAttr)continue;if(!p.keepAttr){me(k,a);continue}if(!Yt&&K(/\/>/i,B)){me(k,a);continue}ce&&qe([at,lt,ct],ms=>{B=Oe(B,ms," ")});const ps=F(a.nodeName);if(!hs(ps,ve,B)){me(k,a);continue}if(w&&typeof O=="object"&&typeof O.getAttributeType=="function"&&!V)switch(O.getAttributeType(ps,ve)){case"TrustedHTML":{B=w.createHTML(B);break}case"TrustedScriptURL":{B=w.createScriptURL(B);break}}if(B!==At)try{V?a.setAttributeNS(V,k,B):a.setAttribute(k,B),Et(a)?X(a):Us(e.removed)}catch{me(k,a)}}ee(U.afterSanitizeAttributes,a,null)},Hn=function b(a){let d=null;const p=ls(a);for(ee(U.beforeSanitizeShadowDOM,a,null);d=p.nextNode();)ee(U.uponSanitizeShadowNode,d,null),us(d),fs(d),d.content instanceof i&&b(d.content);ee(U.afterSanitizeShadowDOM,a,null)};return e.sanitize=function(b){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=null,p=null,S=null,D=null;if(gt=!b,gt&&(b="<!-->"),typeof b!="string"&&!cs(b))if(typeof b.toString=="function"){if(b=b.toString(),typeof b!="string")throw Se("dirty is not a string, aborting")}else throw Se("toString is not a function");if(!e.isSupported)return b;if(dt||bt(a),e.removed=[],typeof b=="string"&&(Ee=!1),Ee){if(b.nodeName){const te=F(b.nodeName);if(!L[te]||be[te])throw Se("root node is forbidden and cannot be sanitized in-place")}}else if(b instanceof l)d=as("<!---->"),p=d.ownerDocument.importNode(b,!0),p.nodeType===_e.element&&p.nodeName==="BODY"||p.nodeName==="HTML"?d=p:d.appendChild(p);else{if(!ue&&!ce&&!ne&&b.indexOf("<")===-1)return w&&Ke?w.createHTML(b):b;if(d=as(b),!d)return ue?null:Ke?N:""}d&&ft&&X(d.firstChild);const k=ls(Ee?b:d);for(;S=k.nextNode();)us(S),fs(S),S.content instanceof i&&Hn(S.content);if(Ee)return b;if(ue){if(Ue)for(D=le.call(d.ownerDocument);d.firstChild;)D.appendChild(d.firstChild);else D=d;return(I.shadowroot||I.shadowrootmode)&&(D=kn.call(s,D,!0)),D}let V=ne?d.outerHTML:d.innerHTML;return ne&&L["!doctype"]&&d.ownerDocument&&d.ownerDocument.doctype&&d.ownerDocument.doctype.name&&K(Mn,d.ownerDocument.doctype.name)&&(V="<!DOCTYPE "+d.ownerDocument.doctype.name+`>
`+V),ce&&qe([at,lt,ct],te=>{V=Oe(V,te," ")}),w&&Ke?w.createHTML(V):V},e.setConfig=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bt(b),dt=!0},e.clearConfig=function(){pe=null,dt=!1},e.isValidAttribute=function(b,a,d){pe||bt({});const p=F(b),S=F(a);return hs(p,S,d)},e.addHook=function(b,a){typeof a=="function"&&we(U[b],a)},e.removeHook=function(b,a){if(a!==void 0){const d=Fo(U[b],a);return d===-1?void 0:Io(U[b],d,1)[0]}return Us(U[b])},e.removeHooks=function(b){U[b]=[]},e.removeAllHooks=function(){U=qs()},e}var Zo=Nn();class Qo extends De{static targets=["fileInput","chatMessages","apiKeyModal","apiKeyInput","apiKeyErrorOutput","showApiKeyTemplate","hideApiKeyTemplate","saveApiKeyButton","saveButtonText","savingButtonText","conversationsList","messagesContainer","typingIndicator","filePreviewsContainer","filePreviews","promptInput","askGeminiButton","newChatButton","maskedApiKeyDisplay","askButtonText","askButtonSpinner","newChatButtonText","newChatButtonSpinner","chatLoadingOverlay"];static values={csrfToken:String,initialConvId:String,prompt:String,messages:Array,files:Array,isUploading:Boolean,conversations:Array,currentConversationId:String,isTyping:Boolean,apiKey:String,isApiKeyNeeded:Boolean,showApiKey:Boolean,apiKeyError:String,isSavingApiKey:Boolean,professorAvatarUrl:String,maskedApiKey:String,isChatLoading:Boolean,isLoadingConversation:Boolean};messageHasFiles=e=>e.files&&e.files.length>0;messageFileGridClass=e=>e.files.length===1?"grid-cols-1":e.files.length===2?"grid-cols-2":"grid-cols-3";isImageFile=e=>e.type.startsWith("image/");connect(){console.log("Stimulus GeminiAssistantController connected.");const e=localStorage.getItem("gemini_api_key");console.log("[Connect] Stored API Key:",e),!e||e.trim()===""?(console.log("[Connect] No API key found or it is empty. Showing modal."),this.isApiKeyNeeded=!0,requestAnimationFrame(()=>{this.apiKeyModalTarget.style.display="flex",console.log('[Connect - requestAnimationFrame] API Key modal display set to "flex".')})):(console.log("[Connect] API key found. Hiding modal and fetching conversations."),this.apiKey=e,this.isApiKeyNeeded=!1,this.apiKeyModalTarget.style.display="none",this.fetchConversations()),console.log("[Connect] apiKeyModalTarget.style.display after initial connect logic:",this.apiKeyModalTarget.style.display),this.apiKey&&(this.maskedApiKey=this.maskApiKey(this.apiKey)),this.initialConvIdValue?this.loadConversation(this.initialConvIdValue):this.fetchConversations()}get prompt(){return this.promptInputValue}set prompt(e){this.promptInputValue=e}get messages(){return this.messagesValue}set messages(e){this.messagesValue=e}get files(){return this.filesValue}set files(e){this.filesValue=e}get isUploading(){return this.isUploadingValue}set isUploading(e){this.isUploadingValue=e}get conversations(){return this.conversationsValue}set conversations(e){this.conversationsValue=e}get currentConversationId(){return this.currentConversationIdValue}set currentConversationId(e){this.currentConversationIdValue=e}get isTyping(){return this.isTypingValue}set isTyping(e){this.isTypingValue=e,this.typingIndicatorTarget.hidden=!e,this.askGeminiButtonTarget.disabled=e,this.askButtonTextTarget.hidden=e,this.askButtonSpinnerTarget.hidden=!e,e&&(this.scrollChatToBottom(),this.isChatLoading=!1)}get apiKey(){return this.apiKeyValue}set apiKey(e){this.apiKeyValue=e,this.maskedApiKey=this.maskApiKey(e)}get isApiKeyNeeded(){return this.isApiKeyNeededValue}set isApiKeyNeeded(e){this.isApiKeyNeededValue=e}get showApiKey(){return this.showApiKeyValue}set showApiKey(e){this.showApiKeyValue=e,this.apiKeyInputTarget.type=e?"text":"password",this.showApiKeyTemplateTarget.hidden=!e,this.hideApiKeyTemplateTarget.hidden=e}get apiKeyError(){return this.apiKeyErrorValue}set apiKeyError(e){this.apiKeyErrorValue=e,this.apiKeyErrorOutputTarget.textContent=e,this.apiKeyErrorOutputTarget.hidden=!e,this.apiKeyInputTarget.classList.toggle("border-red-500",!!e),this.apiKeyInputTarget.classList.toggle("focus:ring-red-500",!!e),this.apiKeyInputTarget.classList.toggle("border-gray-300",!e),this.apiKeyInputTarget.classList.toggle("focus:ring-blue-500",!e)}get isSavingApiKey(){return this.isSavingApiKeyValue}set isSavingApiKey(e){this.isSavingApiKeyValue=e,this.saveApiKeyButtonTarget.disabled=e,this.saveApiKeyButtonTarget.classList.toggle("opacity-50",e),this.saveApiKeyButtonTarget.classList.toggle("cursor-not-allowed",e),this.saveButtonTextTarget.hidden=e,this.savingButtonTextTarget.hidden=!e}get maskedApiKey(){return this.maskedApiKeyValue}set maskedApiKey(e){this.maskedApiKeyValue=e,this.hasMaskedApiKeyDisplayTarget&&(this.maskedApiKeyDisplayTarget.textContent=e,this.maskedApiKeyDisplayTarget.hidden=!e)}get isChatLoading(){return this.isChatLoadingValue}set isChatLoading(e){this.isChatLoadingValue=e,this.hasChatLoadingOverlayTarget&&(this.chatLoadingOverlayTarget.hidden=!e)}get isLoadingConversation(){return this.isLoadingConversationValue}set isLoadingConversation(e){this.isLoadingConversationValue=e,this.renderConversations()}maskApiKey(e){return!e||e.length<=8?e:e.substring(0,4)+"..."+e.substring(e.length-4)}async fetchConversations(){this.isChatLoading=!0;try{const e=await fetch("/conversations",{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":this.csrfTokenValue}});if(!e.ok)throw new Error("Failed to fetch conversations");const t=await e.json();if(this.conversations=t.conversations,this.renderConversations(),this.conversations.length>0){const s=this.conversations.find(r=>r.messages_count===0);s?this.loadConversation(s.id):this.loadConversation(this.conversations[0].id)}else this.startNewConversation()}catch(e){console.error("Error fetching conversations:",e)}finally{this.isChatLoading=!1}}async startNewConversation(){console.log("startNewConversation called."),this.newChatButtonTarget.disabled=!0,this.newChatButtonTextTarget.hidden=!0,this.newChatButtonSpinnerTarget.hidden=!1;const e=this.conversations.find(t=>t.messages_count===0);if(e){this.loadConversation(e.id),this.newChatButtonTarget.disabled=!1,this.newChatButtonTextTarget.hidden=!1,this.newChatButtonSpinnerTarget.hidden=!0;return}try{const t=await fetch("/conversations/new",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":this.csrfTokenValue},body:JSON.stringify({title:"New Chat"})});if(!t.ok)throw new Error("Failed to create new conversation");const s=await t.json();this.currentConversationId=s.conversation_id,this.messages=[],console.log("Calling displayIntroMessage in startNewConversation."),this.displayIntroMessage(),console.log("Messages after displayIntroMessage in startNewConversation:",this.messages),this.prompt="",this.files=[],this.hasFileInputTarget&&(this.fileInputTarget.value=""),this.currentConversationId===this.initialConvIdValue&&!this.initialConvIdValue?window.history.pushState({},"","/"):window.history.pushState({},"",`/${this.currentConversationId}`),await this.fetchConversations()}catch(t){console.error("Error starting new conversation:",t)}finally{this.newChatButtonTarget.disabled=!1,this.newChatButtonTextTarget.hidden=!1,this.newChatButtonSpinnerTarget.hidden=!0}}displayIntroMessage(){console.log("displayIntroMessage called."),this.messages=[{role:"assistant",content:"Welcome! I am Professor Johnson. I am here to guide you with your capstone project. Huwag mahiyang magtanong, but make sure your questions are well-thought-out. Let's begin."}],console.log("Intro message added to messages:",this.messages)}async loadConversation(e){console.log(`Attempting to load conversation: ${e}`),this.isChatLoading=!0;try{const t=await fetch(`/conversations/${e}/messages`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":this.csrfTokenValue}});if(!t.ok){const r=await t.json();throw console.error("Failed to load conversation messages:",r),new Error(r.message||"Failed to load conversation messages")}const s=await t.json();console.log("Conversation messages loaded:",s),console.log("Raw messages from API:",s.messages),this.messages=s.messages.map(r=>{const i=r.file_ids?r.file_ids.map(o=>({id:o,name:o,type:"application/octet-stream",url:null,sizeText:"N/A",rawFile:null})):[];return{role:r.role,content:r.content,files:i}}),this.messages.length===0?(console.log("Conversation is empty, calling displayIntroMessage."),this.displayIntroMessage()):console.log("Conversation is not empty, not calling displayIntroMessage."),console.log("Messages after loadConversation logic:",this.messages),this.currentConversationId=e,this.prompt="",this.files=[],this.hasFileInputTarget&&(this.fileInputTarget.value=""),window.history.pushState({},"",`/${e}`),this.renderMessages(),this.renderConversations()}catch(t){console.error("Error loading conversation:",t)}finally{this.isChatLoading=!1,this.isLoadingConversation=!1}}loadConversationAndHistory(e){const t=e.currentTarget.dataset.conversationId;this.isLoadingConversation=!0;try{this.loadConversation(t)}finally{this.isLoadingConversation=!1}window.history.pushState({},"",`/${t}`)}async deleteConversation(e){const t=e.currentTarget.dataset.conversationId;if(confirm("Are you sure you want to delete this conversation?")){this.isLoadingConversation=!0;try{if(!(await fetch(`/conversations/${t}`,{method:"DELETE",headers:{Accept:"application/json","X-CSRF-TOKEN":this.csrfTokenValue}})).ok)throw new Error("Failed to delete conversation");await this.fetchConversations(),this.currentConversationId===t&&(this.currentConversationId=null,this.messages=[],this.prompt="",this.files=[],this.hasFileInputTarget&&(this.fileInputTarget.value=""),this.conversations.length>0?this.loadConversation(this.conversations[0].id):window.location.reload()),this.renderConversations()}catch(s){console.error("Error deleting conversation:",s)}finally{this.isLoadingConversation=!1}}}updatePrompt(e){this.prompt=e.target.value}handlePaste(e){const t=(e.clipboardData||window.clipboardData).items;for(const s of t)if(s.type.indexOf("image")!==-1){const r=s.getAsFile(),i=new File([r],"pasted-image.png",{type:r.type});this.files.push(this.processFile(i))}this.files.length>0&&e.preventDefault(),this.renderFilePreviews()}handleFileSelect(){for(const e of this.fileInputTarget.files)this.files.push(this.processFile(e));this.renderFilePreviews()}removeFile(e){const t=e.currentTarget.dataset.fileId;this.files=this.files.filter(s=>s.id!==t),this.renderFilePreviews()}handleEnter(e){e.shiftKey?this.prompt+=`
`:this.askGemini()}async askGemini(){if(this.prompt.trim()===""&&this.files.length===0)return;this.currentConversationId||await this.startNewConversation();const e=[...this.files],t={role:"user",content:this.prompt,files:e.map(r=>({name:r.name,type:r.type,url:r.url}))};this.messages=[...this.messages,t],this.prompt="",this.promptInputTarget.value="",this.files=[],this.hasFileInputTarget&&(this.fileInputTarget.value=""),this.isTyping=!0,this.isChatLoading=!0,this.renderMessages();const s=[];if(e.length>0){this.isUploading=!0;try{for(const r of e){const i=new FormData;i.append("file",r.rawFile);const o=await fetch("/upload-file",{method:"POST",headers:{"X-CSRF-TOKEN":this.csrfTokenValue},body:i});if(!o.ok){const f=await o.json(),u=f.errors?Object.values(f.errors).flat().join(" "):f.message||"File upload failed";throw new Error(u)}const l=await o.json();s.push(l.fileId)}}catch(r){console.error("Error uploading files:",r),this.messages[this.messages.length-1].content=`Sorry, a file upload failed: ${r.message}`,this.isUploading=!1,this.files=[],this.hasFileInputTarget&&(this.fileInputTarget.value=""),this.renderMessages();return}finally{this.isUploading=!1}}try{const r=await fetch("/ask-gemini",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.csrfTokenValue},body:JSON.stringify({prompt:t.content,fileIds:s,conversation_id:this.currentConversationId,api_key:this.apiKey})});if(!r.ok){const u=await r.json();throw new Error(u.error||"Network response was not ok")}const i=await r.json(),o=i.output||"Sorry, something went wrong.",l=i.conversation_id;l&&this.currentConversationId!==l&&(this.currentConversationId=l),await this.loadConversation(this.currentConversationId);const f=this.conversations.findIndex(u=>u.id===this.currentConversationId);if(f!==-1&&this.conversations[f].title==="New Chat"&&t.content.trim()!=="")try{const u=await fetch("/conversations/title",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.csrfTokenValue},body:JSON.stringify({conversation_id:this.currentConversationId,user_prompt:t.content,api_key:this.apiKey})});if(u.ok){const h=await u.json();h.success&&(this.conversations[f].title=h.new_title)}else console.error("Failed to update conversation title:",await u.json())}catch(u){console.error("Error updating conversation title:",u)}}catch(r){console.error("Error asking Gemini:",r),this.messages[this.messages.length-1].content=`Sorry, an error occurred: ${r.message}`}finally{this.isTyping=!1,this.isChatLoading=!1,this.renderMessages()}}async validateAndSaveApiKey(){console.log("validateAndSaveApiKey function called."),console.log("Current API Key:",this.apiKey),this.isSavingApiKey=!0,this.apiKeyError="",console.log("Attempting to validate API key...");try{const e=await fetch("/validate-api-key",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.csrfTokenValue},body:JSON.stringify({api_key:this.apiKey})});if(e.ok)console.log("API Key validated successfully."),localStorage.setItem("gemini_api_key",this.apiKey),this.isApiKeyNeeded=!1,this.apiKeyModalTarget.style.display="none",this.maskedApiKey=this.maskApiKey(this.apiKey),await this.fetchConversations(),console.log("API Key modal should now be hidden and conversations fetched.");else{const t=await e.json();console.error("API Key validation failed:",t),this.apiKeyError=t.message||"Invalid API Key. Please check your key and try again.",localStorage.removeItem("gemini_api_key"),this.maskedApiKey=""}}catch(e){console.error("Error during API key validation fetch:",e),this.apiKeyError="An error occurred while validating the API key.",localStorage.removeItem("gemini_api_key"),this.maskedApiKey=""}finally{this.isSavingApiKey=!1}}toggleApiKeyVisibility(){console.log("toggleApiKeyVisibility called."),this.showApiKey=!this.showApiKey,this.apiKeyError=""}updateApiKey(e){this.apiKey=e.target.value}processFile(e){const t=URL.createObjectURL(e),s=(e.size/1024).toFixed(1);return{id:t,name:e.name,type:e.type,url:e.type.startsWith("image/")?URL.createObjectURL(e):null,sizeText:`${s} KB`,rawFile:e}}scrollChatToBottom(){this.hasChatMessagesTarget&&(this.chatMessagesTarget.scrollTop=this.chatMessagesTarget.scrollHeight)}triggerFileInput(){this.fileInputTarget.click()}get isPromptEmpty(){return this.prompt.trim()===""&&this.files.length===0}renderConversations(){this.conversationsListTarget.innerHTML="",this.conversations.forEach(e=>{const t=this.currentConversationId===e.id,s=t&&this.isLoadingConversation,r=`
                <div class="conversation-item rounded-lg cursor-pointer ${t?"border-blue-500 border":""} ${s?"opacity-75 cursor-wait":""}"
                     data-action="click->gemini-assistant#loadConversationAndHistory"
                     data-conversation-id="${e.id}">
                    <div class="flex items-center justify-between p-3">
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium text-white truncate">${e.title}</p>
                            <p class="text-xs text-gray-400 mt-1">2 hours ago</p>
                        </div>
                        ${s?`
                            <svg class="animate-spin h-4 w-4 text-white ml-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        `:`
                            <button data-action="click->gemini-assistant#deleteConversation" data-conversation-id="${e.id}"
                                    class="text-gray-400 hover:text-red-400 p-1 rounded transition-colors">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        `}
                    </div>
                </div>
            `;this.conversationsListTarget.insertAdjacentHTML("beforeend",r)})}renderMessages(){this.messagesContainerTarget.innerHTML="";const e=this;this.messages.forEach(t=>{let s="";if(t.role==="user"){let r="";e.messageHasFiles(t)&&(r=`
                        <div class="mb-2 grid gap-2 ${e.messageFileGridClass(t)}">
                            ${t.files.map(i=>`
                                <div>
                                    ${e.isImageFile(i)?`<img src="${i.url}" class="rounded-lg max-h-48 w-full object-cover">`:`
                                        <div class="p-2 rounded-lg bg-blue-500 text-white flex items-center">
                                            <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                            </svg>
                                            <span class="text-sm truncate">${i.name}</span>
                                        </div>
                                    `}
                                </div>
                            `).join("")}
                        </div>
                    `),s=`
                    <div class="message-bubble">
                        <div class="flex justify-end mb-4">
                            <div class="flex items-end max-w-xs lg:max-w-md">
                                <div class="bg-blue-600 text-white p-3 rounded-2xl rounded-br-md shadow-lg">
                                    ${r}
                                    ${e.messageHasContent(t)?`<p class="text-sm whitespace-pre-wrap">${t.content}</p>`:""}
                                </div>
                                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center ml-2 flex-shrink-0">
                                    <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                `}else t.role==="assistant"&&(s=`
                    <div class="message-bubble">
                        <div class="flex justify-start mb-4">
                            <div class="flex items-end max-w-xs lg:max-w-2xl">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center mr-2 flex-shrink-0 overflow-hidden">
                                    <img src="${e.professorAvatarUrlValue}" alt="Professor Avatar" class="w-full h-full object-cover">
                                </div>
                                <div class="bg-white border border-gray-200 p-3 rounded-2xl rounded-bl-md shadow-sm">
                                    <div class="text-sm text-gray-800 whitespace-pre-wrap prose">${e.renderMarkdown(t.content)}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `);this.messagesContainerTarget.insertAdjacentHTML("beforeend",s)}),e.scrollChatToBottom()}messageHasContent=e=>e.content&&e.content.trim()!=="";renderMarkdown=e=>Zo.sanitize(marked.parse(e));renderFilePreviews(){this.files.length>0?(this.filePreviewsContainerTarget.hidden=!1,this.filePreviewsTarget.innerHTML="",this.files.forEach(e=>{const t=`
                    <div class="file-preview relative bg-gray-50 border border-gray-200 rounded-lg p-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 flex-shrink-0 mr-3">
                                ${this.isImageFile(e)?`<img src="${e.url}" class="w-full h-full rounded-md object-cover">`:`
                                    <div class="w-full h-full rounded-md bg-blue-100 flex items-center justify-center">
                                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                        </svg>
                                    </div>
                                `}
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm font-medium text-gray-900 truncate">${e.name}</p>
                                <p class="text-xs text-gray-500">${e.sizeText}</p>
                            </div>
                        </div>
                        <button data-action="click->gemini-assistant#removeFile" data-file-id="${e.id}"
                                class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                `;this.filePreviewsTarget.insertAdjacentHTML("beforeend",t)})):this.filePreviewsContainerTarget.hidden=!0}}console.log("Stimulus Application Start Attempted");const ea=mo.start();ea.register("gemini-assistant",Qo);console.log("Stimulus Application Registered");
